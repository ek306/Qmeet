{% extends 'base.html' %}
{% block content %}

    <div id="page-details">
        <h1>Event Detail</h1>

        <table id="event-details">
            <tr>
                <th>Event name</th>
                <td>{{ event.title }}</td>
            </tr>
            <tr>
                <th>Hosted by</th>
                <td>{{ event.host.username }}</td>
            </tr>
            <tr>
                <th>Event location</th>
                <td>{{ event.location }}</td>
            </tr>
            <tr>
                <th>Event start date</th>
                <td>{{ event.start_date }}</td>
            </tr>
            <tr>
                <th>Event end date</th>
                <td>{{ event.end_date }}</td>
            </tr>
            <tr>
                <th>Event end date</th>
                <td>{{ event.end_date }}</td>
            </tr>
            <tr>
                <th>Event capacity</th>
                <td>{{ event.capacity }}</td>
            </tr>
        </table>

        {% if event.capacity == 100 %}
            <p>This event has capacity of exactly 100 people!</p>
        {% endif %}

        <div id="join-event-div">

        </div>
    </div>

    <script>

        $(document).ready(function() {
            $.ajax({
                url: "{% url 'check user is host' %}",
                type: "GET",
                data: {
                    'event_host_spid': {{ event.host.studentprofile.id }},
                    'event_id': {{ event.id }}
                },
                success: function (data) {
                    if (data.context == "Host") {
                        $("#join-event-div").append('<button class="btn" type="button" id="update-event-button"><a href="{% url "update event page" %}?event_id={{ event.id }}">Update event</a></button>')
                    }

                    else if (data.context == "Neither") {
                        $("#join-event-div").append('<button class="btn" type="button" id="join-event-button"><a href="{% url "join event" %}?event_id={{ event.id }}">Join event</a></button>')
                    }

                    else {
                        $("#join-event-div").append('<button class="btn" type="button" id="leave-event-button"><a href="{% url "leave event" %}?event_id={{ event.id }}">Leave event</a></button>')
                    }
                }
            })
        })

    </script>

{% endblock %}